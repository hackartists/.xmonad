#+title: Xmonad Config

* Setup
+ Clone this repository in =$HOME/.xmonad=.

* Ranger File manager

** Requiremnets
+ Google chrome uses Dbus

#+begin_src sh
  yay -S xdg-desktop-portal xdg-desktop-portal-xapp xdg-desktop-portal-termfilechooser-git kitty python-pydbus --noconfirm
#+end_src

** Configure XDG Desktop Portal
*** Create xdg-desktop-portal config
+ $HOME/.config/xdg-desktop-portal/portals.conf
#+begin_src conf
  [preferred]
  default=xapp
  org.freedesktop.impl.portal.FileChooser=termfilechooser;xapp;
  org.freedesktop.FileManager1=xapp;
#+end_src

*** Create termfilechooser config
+ $HOME/.config/xdg-desktop-portal-termfilechooser/config

#+begin_src conf
  [filechooser]
  cmd=/usr/share/xdg-desktop-portal-termfilechooser/ranger-wrapper.sh
#+end_src


*** Xmonad Startup Setup
**** Running xdg-termfilechooser config
+ Manually start xdg-deskto-portal-termfilechooser by the command below
  + You can start it by systemd
+ =FileChooser= dbus
#+begin_src shell
  /usr/lib/xdg-desktop-portal-termfilechooser -c $HOME/.config/xdg-desktop-portal-termfilechooser/config -l DEBUG
  # systemctl --user enable --now xdg-desktop-portal-termfilechooser
#+end_src

**** Change FileManger
+ =FileManager1= dbus

#+begin_src shell
  PYTHONPATH=$HOME/.xmonad/py python -m ranger-dbus.py &
#+end_src


* KDE Desktop Setup
*** Configure KDE Desktop
+ Setting =$HOME/.xinitrc= file

#+begin_src conf
  export GTK_THEME=Adwaita:dark
  export XDG_SESSION_TYPE=x11

  export DE='kde'
  export XDG_CURRENT_DESKTOP=KDE
  export KDE_SESSION_VERSION=5
  export XDG_MENU_PREFIX=plasma-
  export XDG_CONFIG_DIRS=/home/hackartist/.config/kdedefaults:/etc/xdg

  exec xmonad &> ~/xmonad.log
#+end_src

*** Starting X11
+ Guarantee stopping =xdg-desktop-portal=
  + Execute the below command if you are trying to run X11 twice or more.
#+begin_src sh
  systemctl stop --user xdg-desktop-portal.service
#+end_src

** Link ranger kdialog
#+begin_src sh
  sudo ln -s $HOME/.xmonad/bin/ranger-kdialog /usr/local/bin/kdialog
#+end_src

